#-------------------------------------------------------------------------------
# importer
#-------------------------------------------------------------------------------

PROJECT(importer)

SET(QT_USE_QTXML TRUE)
SET(QT_USE_QTNETWORK TRUE)

INCLUDE_DIRECTORIES(${CMAKE_CURRENT_BINARY_DIR}
					${Nebula3_SOURCE_DIR}/qttoolkit/qttools/code
					${Nebula3_SOURCE_DIR}/qttoolkit/importer/code
					${Nebula3_SOURCE_DIR}/extlibs/fbx)

LINK_DIRECTORIES(${N_LIBDIRS} ${Nebula3_SOURCE_DIR}/../lib/fbx)


FILE(GLOB_RECURSE SRC "code/*.cpp") 
FILE(GLOB_RECURSE HEAD "code/*.h")
FILE(GLOB FORMS "ui/*.ui")
FILE(GLOB RESOURCES ${QTTOOLS}/ui/*.qrc)

QT4_WRAP_CPP(importer_HEADERS_MOC ${HEAD})
LIST(APPEND SRCS ${SRC} ${HEAD})
INCLUDE(${QT_USE_FILE})
ADD_DEFINITIONS(${QT_DEFINITIONS})
QT4_WRAP_UI(importer_FORMS_HEADERS ${FORMS})
QT4_ADD_RESOURCES(importer_RESOURCES_RCC ${RESOURCES})

SOURCE_GROUP("importer" FILES ${SRCS})

LIST(APPEND ALLSRCS ${SRCS} ${importer_HEADERS_MOC} ${importer_FORMS_HEADERS} ${importer_RESOURCES_RCC})

#STRING(REPLACE "/MTd" "/MDd" CMAKE_CXX_FLAGS_DEBUG ${CMAKE_CXX_FLAGS_DEBUG})
#STRING(REPLACE "/MT" "/MD" CMAKE_CXX_FLAGS_RELEASE ${CMAKE_CXX_FLAGS_RELEASE})
STRING(REPLACE "/MANIFEST:NO" "" CMAKE_EXE_LINKER_FLAGS ${CMAKE_EXE_LINKER_FLAGS})

ADD_EXECUTABLE(importer ${ALLSRCS})

SET_TARGET_PROPERTIES(importer PROPERTIES FOLDER "N3SDK/QtToolkit")				
SET_TARGET_PROPERTIES(importer PROPERTIES PREFIX "../")		
SET_TARGET_PROPERTIES(importer PROPERTIES DEBUG_POSTFIX ".debug")
SET(EXECUTABLE_OUTPUT_PATH   ${Nebula3_SOURCE_DIR}/../bin/win32/)		
		
N_SET_EXE_SUBSYSTEM(importer Windows)

ADD_DEPENDENCIES(importer
	qttools
)
TARGET_LINK_LIBRARIES(importer
	qttools
	debug ${FBX_LIBS_DEBUG} 
	optimized ${FBX_LIBS_RELEASE}
	${N_EXTRA_WIN32_LIBS}
	${QT_WIN_LIBS}
	${QT_LIBRARIES} ${QT_QTMAIN_LIBRARY}
)

SET_PROPERTY(TARGET importer APPEND PROPERTY COMPILE_FLAGS 
    "/wd4789" 
)

SET_PROPERTY(TARGET importer APPEND PROPERTY LINK_FLAGS 
    "/IGNORE:4099" 
)
 
FILE(GLOB SOURCE_GROUP_FILES ${CMAKE_CURRENT_SOURCE_DIR}/*/tools/*)
SOURCE_GROUP(tools FILES ${SOURCE_GROUP_FILES})
FILE(GLOB SOURCE_GROUP_FILES ${CMAKE_CURRENT_SOURCE_DIR}/*/fbx/*)
SOURCE_GROUP(fbx FILES ${SOURCE_GROUP_FILES})

